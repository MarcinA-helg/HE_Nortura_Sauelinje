<StructuredTextModel xmlns="http://schemas.datacontract.org/2004/07/Omron.Cxap.Modules.StructuredText.Core" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><Text>//-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------&#xD;
//	NAME:						HE_EWMA&#xD;
//	CREATOR:					Helgevold - Jan Magne Dybvik&#xD;
// REQUIREMENTS: 		NX CPU&#xD;
//&#xD;
//-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------&#xD;
//  VERSION LOG:&#xD;
//	 VERSION			DATE				SIGN							DESCRIPTION&#xD;
//	 1.0.0				2023-11-07		Jan Magne Dybvik		Initial release&#xD;
//	 2.0.0				2025-03-25		William Veim				Rework&#xD;
//&#xD;
//================================================================================================================================&#xD;
//&#xD;
//			DESCRTIPTION: 	&#xD;
//			Filter where the latest values are weighted more than older values&#xD;
//		&#xD;
//===============================================================================================================================&#xD;
&#xD;
// Initialize&#xD;
IF wrk_firstCycle THEN&#xD;
	wrk_Val := Inp;&#xD;
	wrk_firstCycle := FALSE;&#xD;
END_IF;&#xD;
&#xD;
// Get task interval in seconds&#xD;
wrk_TaskTime := GetMyTaskInterval();&#xD;
wrk_Interval := LINT_TO_REAL(TimeToNanoSec(wrk_TaskTime)) / 1000000000.0;&#xD;
&#xD;
// Get time Constant&#xD;
wrk_TimeCoefficient := (1.0 / Cfg_TC);&#xD;
&#xD;
 IF (Cfg_TC &lt;= 0.0) THEN&#xD;
    wrk_Val := Inp;&#xD;
END_IF;&#xD;
 &#xD;
// Exponentially Weighted Moving Average&#xD;
 IF (wrk_TaskTime &lt;&gt; T#0ms AND Cfg_TC &gt; 0.0) THEN&#xD;
	wrk_Val := ((Inp - wrk_Val) * wrk_TimeCoefficient * wrk_Interval) + wrk_Val;&#xD;
 END_IF;&#xD;
 &#xD;
 IF Inp_ResetFilter THEN&#xD;
    wrk_Val := Inp;&#xD;
END_IF;&#xD;
 &#xD;
Val := wrk_Val;</Text></StructuredTextModel>