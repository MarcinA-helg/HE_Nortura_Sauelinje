<StructuredTextModel xmlns="http://schemas.datacontract.org/2004/07/Omron.Cxap.Modules.StructuredText.Core" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><Text>//-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------&#xD;
//	NAME:				HE_ATV_Last_Fault&#xD;
//	CREATOR:			Helgevold - William Veim&#xD;
//&#xD;
// REQIIUREMENTS: Grundfos CUE com module (MGE whit CUE or MAGNA3)&#xD;
// DESCRTIPTION: 	Generer en string med siste feilkode i frekvensomformeren&#xD;
//-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------&#xD;
//  VERSION LOG:&#xD;
//	 VERSION			DATE					SIGN						DESCRIPTION&#xD;
//	 1.0					2023-11-09		William Veim				Initial release&#xD;
//&#xD;
//================================================================================================================================&#xD;
&#xD;
&#xD;
// Initilize&#xD;
Wrk_FaultValue := WORD_TO_UINT(Inp_LF);&#xD;
Wrk_FaultString := '';&#xD;
Wrk_FaultDescription := '';&#xD;
WRK_FaultCode := '';&#xD;
&#xD;
Wrk_LF_Value := INT_TO_STRING(Wrk_FaultValue);&#xD;
&#xD;
CASE Wrk_FaultValue OF&#xD;
	1 :&#xD;
		WRK_FaultCode := '1';&#xD;
		Wrk_FaultDescription := 'Leaakage current';&#xD;
		&#xD;
	2 :&#xD;
	WRK_FaultCode := '2';&#xD;
	Wrk_FaultDescription := 'Missing phase';&#xD;
	&#xD;
	3 :&#xD;
	WRK_FaultCode := '3';&#xD;
	Wrk_FaultDescription := 'External fault signal';&#xD;
	&#xD;
	4 :&#xD;
	WRK_FaultCode := '4';&#xD;
	Wrk_FaultDescription := 'Too many restarts';&#xD;
	&#xD;
	7 :&#xD;
	WRK_FaultCode := '7';&#xD;
	Wrk_FaultDescription := 'Too many hardware shutdowns';&#xD;
	&#xD;
	14 :&#xD;
	WRK_FaultCode := '14';&#xD;
	Wrk_FaultDescription := 'Electronic DC-link protection activated (ERP)';&#xD;
	&#xD;
	16 :&#xD;
	WRK_FaultCode := '16';&#xD;
	Wrk_FaultDescription := 'Other';&#xD;
	&#xD;
	29 :&#xD;
	WRK_FaultCode := '29';&#xD;
	Wrk_FaultDescription := 'Turbine operation, impellers forced backwards';&#xD;
	&#xD;
	31 :&#xD;
	WRK_FaultCode := '31';&#xD;
	Wrk_FaultDescription := 'Change varistor(s) (specific service information)';&#xD;
	&#xD;
	32 :&#xD;
	WRK_FaultCode := '32';&#xD;
	Wrk_FaultDescription := 'Overvoltage';&#xD;
	&#xD;
	40 :&#xD;
	WRK_FaultCode := '40';&#xD;
	Wrk_FaultDescription := 'Undervoltage';&#xD;
	&#xD;
	41 :&#xD;
	WRK_FaultCode := '41';&#xD;
	Wrk_FaultDescription := 'Undervoltage transient ';&#xD;
	&#xD;
	42 :&#xD;
	WRK_FaultCode := '42';&#xD;
	Wrk_FaultDescription := 'Cut-in fault (dV/dt)';&#xD;
	&#xD;
	45 :&#xD;
	WRK_FaultCode := '45';&#xD;
	Wrk_FaultDescription := 'Voltage asymmetry';&#xD;
	&#xD;
	48 :&#xD;
	WRK_FaultCode := '48';&#xD;
	Wrk_FaultDescription := 'Overload';&#xD;
	&#xD;
	49 :&#xD;
	WRK_FaultCode := '49';&#xD;
	Wrk_FaultDescription := 'Overcurrent (i_line, i_dc, i_mo)';&#xD;
	&#xD;
	50 :&#xD;
	WRK_FaultCode := '50';&#xD;
	Wrk_FaultDescription := 'Motor protection function, general shutdown (MPF)';&#xD;
	&#xD;
	51 :&#xD;
	WRK_FaultCode := '51';&#xD;
	Wrk_FaultDescription := 'Blocked motor or pump';&#xD;
	&#xD;
	54 :&#xD;
	WRK_FaultCode := '54';&#xD;
	Wrk_FaultDescription := 'Motor protection function, 3 sec. limit';&#xD;
	&#xD;
	55 :&#xD;
	WRK_FaultCode := '55';&#xD;
	Wrk_FaultDescription := 'Motor current protection activated (MCP)';&#xD;
	&#xD;
	56 :&#xD;
	WRK_FaultCode := '56';&#xD;
	Wrk_FaultDescription := 'Underload';&#xD;
	&#xD;
	57 :&#xD;
	WRK_FaultCode := '57';&#xD;
	Wrk_FaultDescription := 'Dry running';&#xD;
	&#xD;
	60 :&#xD;
	WRK_FaultCode := '60';&#xD;
	Wrk_FaultDescription := 'Low input power';&#xD;
	&#xD;
	64 :&#xD;
	WRK_FaultCode := '64';&#xD;
	Wrk_FaultDescription := 'Overtemperature';&#xD;
	&#xD;
	65 :&#xD;
	WRK_FaultCode := '64';&#xD;
	Wrk_FaultDescription := 'Motor temperature 1';&#xD;
	&#xD;
	66 :&#xD;
	WRK_FaultCode := '66';&#xD;
	Wrk_FaultDescription := 'Temperature, control electronics';&#xD;
	&#xD;
	67 :&#xD;
	WRK_FaultCode := '67';&#xD;
	Wrk_FaultDescription := 'Temperature, control electronics';&#xD;
	&#xD;
	68 :&#xD;
	WRK_FaultCode := '68';&#xD;
	Wrk_FaultDescription := 'External temperature/water temperature';&#xD;
	&#xD;
	70 :&#xD;
	WRK_FaultCode := '70';&#xD;
	Wrk_FaultDescription := 'Thermal relay 2 in motor';&#xD;
	&#xD;
	72 :&#xD;
	WRK_FaultCode := '72';&#xD;
	Wrk_FaultDescription := 'Hardware fault, type 1';&#xD;
	&#xD;
	73 :&#xD;
	WRK_FaultCode := '73';&#xD;
	Wrk_FaultDescription := 'Hardware shutdown (HSD)';&#xD;
	&#xD;
	76 :&#xD;
	WRK_FaultCode := '76';&#xD;
	Wrk_FaultDescription := 'Internal communication fault';&#xD;
	&#xD;
	77 :&#xD;
	WRK_FaultCode := '77';&#xD;
	Wrk_FaultDescription := 'Communication fault, twin-head pump';&#xD;
	&#xD;
	80 :&#xD;
	WRK_FaultCode := '80';&#xD;
	Wrk_FaultDescription := 'Hardware fault, type 2';&#xD;
	&#xD;
	83 :&#xD;
	WRK_FaultCode := '83';&#xD;
	Wrk_FaultDescription := 'Verification error, FE parameter area (EEPROM)';&#xD;
	&#xD;
	84 :&#xD;
	WRK_FaultCode := '84';&#xD;
	Wrk_FaultDescription := 'Memory access error';&#xD;
	&#xD;
	85 :&#xD;
	WRK_FaultCode := '85';&#xD;
	Wrk_FaultDescription := 'Verification error, BE parameter area (EEPROM)';&#xD;
	&#xD;
	88 :&#xD;
	WRK_FaultCode := '88';&#xD;
	Wrk_FaultDescription := 'Sensor fault';&#xD;
	&#xD;
	89 :&#xD;
	WRK_FaultCode := '89';&#xD;
	Wrk_FaultDescription := 'Signal fault, (feedback) sensor 1';&#xD;
	&#xD;
	91 :&#xD;
	WRK_FaultCode := '91';&#xD;
	Wrk_FaultDescription := 'Signal fault, temperature 1 sensor';&#xD;
	&#xD;
	93 :&#xD;
	WRK_FaultCode := '93';&#xD;
	Wrk_FaultDescription := 'Signal fault, sensor 2';&#xD;
	&#xD;
	96 :&#xD;
	WRK_FaultCode := '96';&#xD;
	Wrk_FaultDescription := 'Setpoint signal outside range';&#xD;
	&#xD;
	105 :&#xD;
	WRK_FaultCode := '105';&#xD;
	Wrk_FaultDescription := 'Electronic rectifier protection activated (ERP)';&#xD;
	&#xD;
	106 :&#xD;
	WRK_FaultCode := '106';&#xD;
	Wrk_FaultDescription := 'Electronic inverter protection activated (EIP)';&#xD;
	&#xD;
	148 :&#xD;
	WRK_FaultCode := '148';&#xD;
	Wrk_FaultDescription := 'Motor bearing temperature high in drive';&#xD;
	&#xD;
	149 :&#xD;
	WRK_FaultCode := '149';&#xD;
	Wrk_FaultDescription := 'Motor bearing temperature high in motor ';&#xD;
	&#xD;
	155 :&#xD;
	WRK_FaultCode := '155';&#xD;
	Wrk_FaultDescription := 'Inrush fault';&#xD;
	&#xD;
	156 :&#xD;
	WRK_FaultCode := '156';&#xD;
	Wrk_FaultDescription := 'Communication fault, internal frequency';&#xD;
	&#xD;
	157 :&#xD;
	WRK_FaultCode := '157';&#xD;
	Wrk_FaultDescription := 'Real-time clock out of order';&#xD;
	&#xD;
	161 :&#xD;
	WRK_FaultCode := '161';&#xD;
	Wrk_FaultDescription := 'Sensor supply fault, 5 V';&#xD;
	&#xD;
	162 :&#xD;
	WRK_FaultCode := '162';&#xD;
	Wrk_FaultDescription := 'Sensor supply fault, 24 V';&#xD;
	&#xD;
	163 :&#xD;
	WRK_FaultCode := '163';&#xD;
	Wrk_FaultDescription := 'Measurement fault, motor protection';&#xD;
	&#xD;
	164 :&#xD;
	WRK_FaultCode := '164';&#xD;
	Wrk_FaultDescription := 'Signal fault, LiqTec sensor';&#xD;
	&#xD;
	165 :&#xD;
	WRK_FaultCode := '165';&#xD;
	Wrk_FaultDescription := 'Signal fault, analog input 1';&#xD;
	&#xD;
	166 :&#xD;
	WRK_FaultCode := '166';&#xD;
	Wrk_FaultDescription := 'Signal fault, analog input 2';&#xD;
	&#xD;
	167 :&#xD;
	WRK_FaultCode := '167';&#xD;
	Wrk_FaultDescription := 'Signal fault, analog input 3';&#xD;
	&#xD;
	175 :&#xD;
	WRK_FaultCode := '175';&#xD;
	Wrk_FaultDescription := 'Signal fault, temperature 2 sensor';&#xD;
	&#xD;
	176 :&#xD;
	WRK_FaultCode := '176';&#xD;
	Wrk_FaultDescription := 'Signal fault, temperature 3 sensor';&#xD;
	&#xD;
	190 :&#xD;
	WRK_FaultCode := '190';&#xD;
	Wrk_FaultDescription := 'Limit exceeded, sensor 1';&#xD;
	&#xD;
	191 :&#xD;
	WRK_FaultCode := '191';&#xD;
	Wrk_FaultDescription := 'Limit exceeded, sensor 2';&#xD;
	&#xD;
	215 :&#xD;
	WRK_FaultCode := '215';&#xD;
	Wrk_FaultDescription := 'Soft pressure buildup timeout';&#xD;
	&#xD;
	240 :&#xD;
	WRK_FaultCode := '240';&#xD;
	Wrk_FaultDescription := 'Lubricate bearings';&#xD;
	&#xD;
	241 :&#xD;
	WRK_FaultCode := '241';&#xD;
	Wrk_FaultDescription := 'Motor phase failure';&#xD;
	&#xD;
	242 :&#xD;
	WRK_FaultCode := '242';&#xD;
	Wrk_FaultDescription := 'Automatic motor model recognition failed';&#xD;
	&#xD;
	//TO BE CONTINUED&#xD;
&#xD;
		&#xD;
ELSE&#xD;
	WRK_FaultCode := '???';&#xD;
	Wrk_FaultDescription := 'Unkown Fault';&#xD;
&#xD;
END_CASE;&#xD;
&#xD;
&#xD;
&#xD;
&#xD;
// Add LFT Code&#xD;
IF TestABit(In:=Cfg_Composition, Pos:=0) THEN&#xD;
	Wrk_FaultString := CONCAT(Wrk_FaultString, Wrk_LF_Value);&#xD;
END_IF;	&#xD;
&#xD;
&#xD;
// Add Fault Code&#xD;
IF TestABit(In:=Cfg_Composition, Pos:=1) THEN&#xD;
	IF LEN(Wrk_FaultString) &gt; 0 THEN&#xD;
		Wrk_FaultString := CONCAT(Wrk_FaultString, Cfg_Delimiter);&#xD;
	END_IF;&#xD;
	Wrk_FaultString := CONCAT(Wrk_FaultString, WRK_FaultCode);&#xD;
END_IF;&#xD;
&#xD;
// Add Fault Description&#xD;
IF TestABit(In:=Cfg_Composition, Pos:=2) THEN&#xD;
	IF LEN(Wrk_FaultString) &gt; 0 THEN&#xD;
		Wrk_FaultString := CONCAT(Wrk_FaultString, Cfg_Delimiter);&#xD;
	END_IF;&#xD;
	Wrk_FaultString := CONCAT(Wrk_FaultString, Wrk_FaultDescription);&#xD;
END_IF;&#xD;
&#xD;
HE_CIM500_Last_Fault := Wrk_FaultString;</Text></StructuredTextModel>