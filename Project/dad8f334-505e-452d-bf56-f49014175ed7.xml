<StructuredTextModel xmlns="http://schemas.datacontract.org/2004/07/Omron.Cxap.Modules.StructuredText.Core" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><Text>//-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------&#xD;
//	NAME:				HE_WEG_Drive_Fault&#xD;
//	CREATOR:			Helgevold - Jan Magne Dybvik&#xD;
//&#xD;
// REQUIREMENTS: WEG CFW900&#xD;
// DESCRTIPTION: 	Generates a string with fault code and description&#xD;
//-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------&#xD;
//  VERSION LOG:&#xD;
//	 VERSION			DATE				SIGN						DESCRIPTION&#xD;
//	 1.0					2025-02-11		Jan Magne Dybvik	Initial release&#xD;
//&#xD;
//================================================================================================================================&#xD;
&#xD;
&#xD;
// Initilize&#xD;
Wrk_FaultValue := DWORD_TO_UDINT(Inp_InverterFault);&#xD;
Wrk_FaultString := '';&#xD;
Wrk_FaultDescription := '';&#xD;
&#xD;
Wrk_FaultCode := UDINT_TO_STRING(Wrk_FaultValue);&#xD;
&#xD;
CASE Wrk_FaultValue OF&#xD;
	1:&#xD;
		Wrk_FaultDescription := 'Brake check';&#xD;
	2:&#xD;
		Wrk_FaultDescription := 'Power card temperature';&#xD;
	4:&#xD;
		Wrk_FaultDescription := 'Ground fault';&#xD;
	8:&#xD;
		Wrk_FaultDescription := 'Control card temperature';&#xD;
	16:&#xD;
		Wrk_FaultDescription := 'Control word TO';&#xD;
	32:&#xD;
		Wrk_FaultDescription := 'Overcurrent';&#xD;
	64:&#xD;
		Wrk_FaultDescription := 'Torque limit';&#xD;
	128:&#xD;
		Wrk_FaultDescription := 'Motor th over (A11)';&#xD;
	256:&#xD;
		Wrk_FaultDescription := 'Motor ETR over';&#xD;
	512:&#xD;
		Wrk_FaultDescription := 'Inverter overload';&#xD;
	1024:&#xD;
		Wrk_FaultDescription := 'DC undervoltage';&#xD;
	2048:&#xD;
		Wrk_FaultDescription := 'DC overvoltage';&#xD;
	4096:&#xD;
		Wrk_FaultDescription := 'Short circuit';&#xD;
	8192:&#xD;
		Wrk_FaultDescription := 'Inrush fault';&#xD;
	16384:&#xD;
		Wrk_FaultDescription := 'Mains phase loss';&#xD;
	32768:&#xD;
		Wrk_FaultDescription := 'AMA nok OK';&#xD;
	65536:&#xD;
		Wrk_FaultDescription := 'Live zero error';&#xD;
	131072:&#xD;
		Wrk_FaultDescription := 'Internal fault';&#xD;
	262144:&#xD;
		Wrk_FaultDescription := 'Brake overload';&#xD;
	524288:&#xD;
		Wrk_FaultDescription := 'U-phase loss';&#xD;
	1048576:&#xD;
		Wrk_FaultDescription := 'V-phase loss';&#xD;
	2097152:&#xD;
		Wrk_FaultDescription := 'W-phase loss';&#xD;
	4194304:&#xD;
		Wrk_FaultDescription := 'Fieldbus fault';&#xD;
	8388608:&#xD;
		Wrk_FaultDescription := '24VDC supply low';&#xD;
	16777216:&#xD;
		Wrk_FaultDescription := 'Mains failiure';&#xD;
	33554432:&#xD;
		Wrk_FaultDescription := '1.8V supply low';&#xD;
	67108864:&#xD;
		Wrk_FaultDescription := 'Brake resistor';&#xD;
	134217728:&#xD;
		Wrk_FaultDescription := 'Brake IGBT';	&#xD;
	268435456:&#xD;
		Wrk_FaultDescription := 'Option change';	&#xD;
	536870912:&#xD;
		Wrk_FaultDescription := 'Drive initialized';&#xD;
	1073741824:&#xD;
		Wrk_FaultDescription := 'Safe stop';	&#xD;
	2147483648:&#xD;
		Wrk_FaultDescription := 'Mech.brake low';	&#xD;
&#xD;
&#xD;
ELSE&#xD;
	Wrk_FaultDescription := 'See Manual';&#xD;
&#xD;
END_CASE;&#xD;
&#xD;
&#xD;
// Add Status Code&#xD;
IF TestABit(In:=Cfg_Composition, Pos:=0) THEN&#xD;
	Wrk_FaultString := CONCAT(Wrk_FaultString, Wrk_FaultCode);&#xD;
END_IF;	&#xD;
&#xD;
&#xD;
// Add State Description&#xD;
IF TestABit(In:=Cfg_Composition, Pos:=1) THEN&#xD;
	IF LEN(Wrk_FaultString) &gt; 0 THEN&#xD;
		Wrk_FaultString := CONCAT(Wrk_FaultString, Cfg_Delimiter);&#xD;
	END_IF;&#xD;
	Wrk_FaultString := CONCAT(Wrk_FaultString, Wrk_FaultDescription);&#xD;
END_IF;&#xD;
&#xD;
HE_FC202_Drive_Fault := Wrk_FaultString;</Text></StructuredTextModel>