<StructuredTextModel xmlns="http://schemas.datacontract.org/2004/07/Omron.Cxap.Modules.StructuredText.Core" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><Text>//-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------&#xD;
//	NAME:					HE_RT100ParseIfaces&#xD;
//	CREATOR:				Helgevold - Jan Magne Dybvik&#xD;
// REQUIREMENTS: NX CPU&#xD;
//&#xD;
// DESCRTIPTION: 	Parse Interface status from Text string&#xD;
//-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------&#xD;
//  VERSION LOG:&#xD;
//	 VERSION			DATE				SIGN						DESCRIPTION&#xD;
//	 1.0					2025-04-01		Jan Magne Dybvik	Initial release&#xD;
//&#xD;
//&#xD;
//================================================================================================================================&#xD;
&#xD;
HE_RT100ParseIfaces := FALSE;&#xD;
Wrk_RecvString :=Inp_RecvString;&#xD;
&#xD;
// Get Uplink 2 status&#xD;
Wrk_Pos := FIND(In1 := Wrk_RecvString, In2 := 'name:UPLINK2');&#xD;
IF Wrk_Pos &gt; 0 THEN&#xD;
	Wrk_RecvString := DELETE(In:=Wrk_RecvString, L:=Wrk_Pos + 12, P:=1);&#xD;
ELSE&#xD;
	RETURN;&#xD;
END_IF;&#xD;
&#xD;
Wrk_Pos := FIND(In1 := Wrk_RecvString, In2 := '0:');&#xD;
IF Wrk_Pos = 1 THEN&#xD;
	Wrk_RecvString := DELETE(In:=Wrk_RecvString, L:=Wrk_Pos + 1, P:=1);&#xD;
ELSE&#xD;
	RETURN;&#xD;
END_IF;&#xD;
&#xD;
Wrk_Pos := FIND(In1 := Wrk_RecvString, In2 := 'linkstate:');&#xD;
IF Wrk_Pos = 1 THEN&#xD;
	Wrk_RecvString := DELETE(In:=Wrk_RecvString, L:=Wrk_Pos + 9, P:=1);&#xD;
	Wrk_Pos := FIND(In1 := Wrk_RecvString, In2 := '$L0:');&#xD;
	Wrk_LinkState := LEFT(In:=Wrk_RecvString, L:=Wrk_Pos - 1);&#xD;
	Wrk_RecvString := DELETE(In:=Wrk_RecvString, L:=Wrk_Pos + 2, P:=1);&#xD;
ELSE&#xD;
	RETURN;&#xD;
END_IF;&#xD;
&#xD;
Wrk_Pos := FIND(In1 := Wrk_RecvString, In2 := 'linkinfo:');&#xD;
IF Wrk_Pos = 1 THEN&#xD;
	Wrk_RecvString := DELETE(In:=Wrk_RecvString, L:=Wrk_Pos + 8, P:=1);&#xD;
	Wrk_Pos := FIND(In1 := Wrk_RecvString, In2 := '[');&#xD;
	Wrk_WirelessGen := LEFT(In:=Wrk_RecvString, L:=Wrk_Pos - 2);&#xD;
	Wrk_RecvString := DELETE(In:=Wrk_RecvString, L:=Wrk_Pos, P:=1);&#xD;
	Wrk_Pos := FIND(In1 := Wrk_RecvString, In2 := ']');&#xD;
	Wrk_Operator := LEFT(In:=Wrk_RecvString, L:=Wrk_Pos - 1);&#xD;
	Wrk_RecvString := DELETE(In:=Wrk_RecvString, L:=Wrk_Pos, P:=1);&#xD;
	Wrk_Pos := FIND(In1 := Wrk_RecvString, In2 := 'SQ:');&#xD;
	Wrk_RecvString := DELETE(In:=Wrk_RecvString, L:=Wrk_Pos + 2, P:=1);&#xD;
	Wrk_Pos := FIND(In1 := Wrk_RecvString, In2 := '$L0:');&#xD;
	Wrk_Signal := STRING_TO_DINT(LEFT(In:=Wrk_RecvString, L:=Wrk_Pos - 1));&#xD;
	Wrk_RecvString := DELETE(In:=Wrk_RecvString, L:=Wrk_Pos  +2, P:=1);&#xD;
ELSE&#xD;
	RETURN;&#xD;
END_IF;&#xD;
&#xD;
Out_LinkState := Wrk_LinkState;&#xD;
Out_WirelessGen := Wrk_WirelessGen;&#xD;
Out_Operator := Wrk_Operator;&#xD;
Out_Signal := Wrk_Signal;&#xD;
&#xD;
HE_RT100ParseIfaces := TRUE; </Text></StructuredTextModel>