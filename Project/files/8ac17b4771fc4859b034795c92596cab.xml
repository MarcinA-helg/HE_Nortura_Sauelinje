<CodeEditorModel xmlns="http://schemas.datacontract.org/2004/07/Omron.Cxap.Modules.DeviceHmi.CodeEditor.Core" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><CodingLanguageName>VBNET</CodingLanguageName><HiddenFooter>&#xD;
End Class</HiddenFooter><HiddenHeader>Partial Public Class NADateTimeIAG&#xD;
</HiddenHeader><Text>Public Structure SYSTEMTIME&#xD;
    Public wYear As UInt16&#xD;
    Public wMonth As UInt16&#xD;
    Public wDayOfWeek As UInt16&#xD;
    Public wDay As UInt16&#xD;
    Public wHour As UInt16&#xD;
    Public wMinute As UInt16&#xD;
    Public wSecond As UInt16&#xD;
    Public wMilliseconds As UInt16&#xD;
End Structure &#xD;
&#xD;
Declare Function GetSystemTime Lib "CoreDll.dll" _&#xD;
    (ByRef lpSystemTime As SYSTEMTIME) As UInt32&#xD;
&#xD;
Declare Function SetSystemTime Lib "CoreDll.dll" _&#xD;
    (ByRef lpSystemTime As SYSTEMTIME) As UInt32&#xD;
&#xD;
Public Function GetNATime() As String&#xD;
    ' Call the native GetSystemTime method &#xD;
    ' with the defined structure. &#xD;
    Dim st As New SYSTEMTIME&#xD;
    GetSystemTime(st)&#xD;
&#xD;
    ' Return the current time&#xD;
   GetNATime = "Current Time: "  &amp; st.wHour.ToString() &amp; ":" &amp; st.wMinute.ToString()&#xD;
End Function &#xD;
&#xD;
Public Function SetNATime(nHour As UInt16,nMinute As UInt16, nSecond As UInt16) As Boolean&#xD;
    ' Call the native GetSystemTime method &#xD;
    ' with the defined structure. &#xD;
   Dim st As New SYSTEMTIME&#xD;
   GetSystemTime(st)&#xD;
&#xD;
   st.wHour = nHour&#xD;
   st.wMinute = nMinute&#xD;
   st.wSecond = nSecond&#xD;
   &#xD;
    SetSystemTime(st)&#xD;
	&#xD;
	SetNATime = True&#xD;
&#xD;
End Function&#xD;
&#xD;
Public Function SetNATime(nTime As TimeSpan) As Boolean&#xD;
	SetNATime(nTime.Hours, nTime.Minutes, nTime.Seconds)&#xD;
	SetNATime = True&#xD;
End Function&#xD;
&#xD;
Public Function SetNATime(nDateTime As Date) As Boolean&#xD;
	SetNATime(nDateTime.Hour, nDateTime.Minute, nDateTime.Second)&#xD;
	SetNATime = True&#xD;
End Function&#xD;
&#xD;
Public Function SetNADateTime(nDay As UInt16, nMonth As UInt16, nYear As UInt16, nHour As UInt16, nMinute As UInt16, nSecond As UInt16) As Boolean&#xD;
    ' Call the native GetSystemTime method &#xD;
    ' with the defined structure. &#xD;
   Dim st As New SYSTEMTIME&#xD;
   GetSystemTime(st)&#xD;
&#xD;
   st.wDay = nDay&#xD;
   st.wMonth = nMonth&#xD;
   st.wYear = nYear&#xD;
   st.wHour = nHour&#xD;
   st.wMinute = nMinute&#xD;
   st.wSecond = nSecond&#xD;
   &#xD;
   SetSystemTime(st)&#xD;
&#xD;
   SetNADateTime = True&#xD;
End Function&#xD;
&#xD;
Public Function SetNADateTime(nDateTime As Date) As Boolean&#xD;
	SetNADateTime(nDateTime.Day, nDateTime.Month, nDateTime.Year, nDateTime.Hour, nDateTime.Minute, nDateTime.Second)&#xD;
	SetNADateTime = True&#xD;
End Function</Text></CodeEditorModel>