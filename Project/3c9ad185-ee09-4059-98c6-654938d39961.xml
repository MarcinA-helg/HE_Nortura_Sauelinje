<StructuredTextModel xmlns="http://schemas.datacontract.org/2004/07/Omron.Cxap.Modules.StructuredText.Core" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><Text>//------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ &#xD;
//	NAME:			Analog Input NX ADX203/4                                                                                                                                                                                                                                                                  &#xD;
//	CREATOR:		Helgevold - Jan Magne Dybvik                                                                                                                                                                                                                                                     &#xD;
//                                                                                                                                                                                                                                                                                                                            &#xD;
//------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ &#xD;
//  VERSION LOG:                                                                                                                                                                                                                                                                                                   &#xD;
//	VERSION		DATE				SIGN								DESCRIPTION                                                                                                                                                                                                                                 &#xD;
//	1.0.0				2025-06-22		Jan Magne Dybvik			Initial release    &#xD;
//	1.0.0				2025-07-14		William Veim					ReWork input module type (moved to function)   &#xD;
//&#xD;
//===============================================================================================================================&#xD;
//&#xD;
//		FUNKSJONALITET:&#xD;
//		*Analog input (signal value) &#xD;
//		*Scaling of raw value to signal value&#xD;
//		*Excecution of analog input logic&#xD;
//&#xD;
//===============================================================================================================================&#xD;
&#xD;
(*************************************************************************&#xD;
 *	BLOCK SPESIFIC PARAMETERS&#xD;
 *************************************************************************)&#xD;
Wrk_AnalogInput_Logic.Cfg_ValueType:=FALSE; //INPUT VALUE TO LOGIC BLOCK IS SIGNAL VALUE&#xD;
&#xD;
HE_AIn_Module(Inp_AInModule:=Cfg_Module, &#xD;
							Out_SignalValue_Y0=&gt;Wrk_SignalValue_Y0, &#xD;
							Out_SignalValue_Y1=&gt;Wrk_SignalValue_Y1, &#xD;
							Out_SignalValue_Min=&gt;Wrk_SignalValue_Min, &#xD;
							Out_SignalValue_Max=&gt;Wrk_SignalValue_Max, &#xD;
							Out_SignalValue_Unit=&gt;Wrk_SignalValue_Unit, &#xD;
							Out_RawValue_LoopBreak=&gt;Wrk_RawValueLoopBreak, &#xD;
							Out_RawValue_X0=&gt;Wrk_RawValue_X0, &#xD;
							Out_RawValue_X1=&gt;Wrk_RawValue_X1, &#xD;
							Out_RawValue_Min=&gt;Wrk_RawValue_Min, &#xD;
							Out_RawValue_Max=&gt;Wrk_RawValue_Max);&#xD;
&#xD;
(*************************************************************************&#xD;
 *	UPDATE INPUT PARAMETERS&#xD;
 *************************************************************************)&#xD;
&#xD;
Wrk_AnalogInput_Logic.Inp_AlmSuppress:=				Inp_AlmSuppress;&#xD;
Wrk_AnalogInput_Logic.Inp_AlmSuppressDesc:=		Inp_AlmSuppressDesc;&#xD;
Wrk_AnalogInput_Logic.Inp_ModuleFault:=				Inp_ModuleFault;&#xD;
Wrk_AnalogInput_Logic.Inp_LoopBreak:=					Wrk_LoopBreak;&#xD;
Wrk_AnalogInput_Logic.Inp_Value:=							ScaleTrans(SclIn:=Inp_RawValue, &#xD;
																										X0:=Wrk_RawValue_Min, &#xD;
																										Y0:=Wrk_SignalValue_Min, &#xD;
																										X1:=Wrk_RawValue_Max, &#xD;
																										Y1:=Wrk_SignalValue_Max);&#xD;
																									&#xD;
Wrk_AnalogInput_Logic.Inp_Value:=							LIMIT(MN:= Wrk_SignalValue_Min, &#xD;
																								In:=Wrk_AnalogInput_Logic.Inp_Value, &#xD;
																								MX:=Wrk_SignalValue_Max);&#xD;
(*************************************************************************&#xD;
 *	UPDATE CONFIG PARAMETERS&#xD;
 *************************************************************************)&#xD;
Wrk_AnalogInput_Logic.Cfg_SignalValue_Y0:=		REAL_TO_UINT(Wrk_SignalValue_Y0);&#xD;
Wrk_AnalogInput_Logic.Cfg_SignalValue_Y1:=		REAL_TO_UINT(Wrk_SignalValue_Y1);&#xD;
Wrk_AnalogInput_Logic.Cfg_SignalValue_Unit:=		Wrk_SignalValue_Unit;&#xD;
Wrk_AnalogInput_Logic.Cfg_ControlCabinet:=		Cfg_ControlCabinet;&#xD;
Wrk_AnalogInput_Logic.Cfg_ControllerTAG:=			Cfg_ControllerTAG;&#xD;
Wrk_AnalogInput_Logic.Cfg_ProcessTAG:=				Cfg_ProcessTAG;&#xD;
Wrk_AnalogInput_Logic.Cfg_AlarmSMS_SignificantDigits :=	Cfg_AlarmSMS_SignificantDigits;&#xD;
Wrk_AnalogInput_Logic.Cfg_AlarmSMS_UseUnitPrefix :=		Cfg_AlarmSMS_UseUnitPrefix;&#xD;
&#xD;
(*************************************************************************&#xD;
 *	UPDATING STATE CONTROL PARAMTERS&#xD;
 *************************************************************************)&#xD;
 //STATE 1 - Locked to "Input stuck"&#xD;
 //STATE 2 - Locked to "Process value out of range"&#xD;
 //STATE 3 - Locked to "Module fault"&#xD;
 &#xD;
Wrk_LoopBreak := Inp_RawValue = Wrk_RawValueLoopBreak; &#xD;
 &#xD;
Wrk_AnalogInput_Logic.Cfg_State4_InUse:= 	TRUE;&#xD;
Wrk_AnalogInput_Logic.Inp_State4_Desc:=	'Signal value out of range';&#xD;
IF Wrk_LoopBreak THEN			//Ignores signal value out of range if loop break is active&#xD;
	Wrk_AnalogInput_Logic.Inp_State4_State := FALSE;&#xD;
ELSE&#xD;
	Wrk_AnalogInput_Logic.Inp_State4_State:= Inp_RawValue &lt; Wrk_RawValue_X0 OR Inp_RawValue &gt; Wrk_RawValue_X1;&#xD;
END_IF;&#xD;
&#xD;
Wrk_AnalogInput_Logic.Cfg_State5_InUse:= 	TRUE;&#xD;
Wrk_AnalogInput_Logic.Inp_State5_Desc:=	'Loop break';&#xD;
Wrk_AnalogInput_Logic.Inp_State5_State:=	Wrk_LoopBreak;&#xD;
&#xD;
(*************************************************************************&#xD;
 *	EXCECUTING LOGICK BLOCK&#xD;
 *************************************************************************)&#xD;
 &#xD;
Wrk_AnalogInput_Logic(ENS:=TRUE, &#xD;
										Ext_AnalogValue:=	Ext_AnalogValue, &#xD;
										Int_Alarm:=				Int_Alarm);&#xD;
&#xD;
(*************************************************************************&#xD;
 *	UPDATING FB OUTPUT&#xD;
 *************************************************************************)&#xD;
 &#xD;
Sts_Fault:= 								Ext_AnalogValue.EXT_General.State_Quality&gt;0;&#xD;
Sts_AlarmToken:=					Wrk_AnalogInput_Logic.Out_AlarmToken;&#xD;
Out_ProcessValue:= 				Ext_AnalogValue.EXT_Operator.ProcessValue;&#xD;
Out_ProcessValue_Percent := 	Ext_AnalogValue.EXT_Operator.ProcessValue_Percent;&#xD;
</Text></StructuredTextModel>